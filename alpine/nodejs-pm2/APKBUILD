# Maintainer: Vincent Trumpff <vincent.tr@gmail.com>

pkgname=nodejs-pm2
pkgver=2.7.2
pkgrel=0
pkgdesc="nodejs PM2"
arch="noarch"
url="http://http://apps.mti-team2.dyndns.org//"
license="GPL3"
depends="nodejs"
source=""

prepare() {
  default_prepare
}

build() {
  cd "$srcdir" && npm install --global-style "pm2@$pkgver"
}

package() {
  install -dm755 "$pkgdir/usr/lib/node_modules"

  install "$srcdir/node_modules/pm2" "$pkgdir/usr/lib/node_modules"

  ln -sr "$pkgdir/usr/lib/node_modules/pm2/bin/pm2" "$pkgdir/usr/bin/pm2"
  ln -sr "$pkgdir/usr/lib/node_modules/pm2/bin/pm2-dev" "$pkgdir/usr/bin/pm2-dev"
  ln -sr "$pkgdir/usr/lib/node_modules/pm2/bin/pm2-docker" "$pkgdir/usr/bin/pm2-docker"
  ln -sr "$pkgdir/usr/lib/node_modules/pm2/bin/pm2-runtime" "$pkgdir/usr/bin/pm2-runtime"
}
